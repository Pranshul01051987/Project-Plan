name: Sync Google Sheet to GitHub Issues

on:
  # Run every hour
  schedule:
    - cron: '0 * * * *'
  
  # Manual trigger
  workflow_dispatch:
  
  # Also run on push to main (for testing)
  push:
    branches: [main]
    paths:
      - '.github/workflows/sync-sheet-to-issues.yml'
      - 'scripts/sync-issues.js'

jobs:
  sync:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v4
      
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Install dependencies
        run: npm install xlsx node-fetch@2
      
      - name: Sync Sheet to Issues
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          SHEET_ID: '1fyFoRxuOWI71S6ZoTkMXZpaEM3Mf00L3x-pV7NOFnYE'
          REPO_OWNER: ${{ github.repository_owner }}
          REPO_NAME: ${{ github.event.repository.name }}
        run: node scripts/sync-issues.js

